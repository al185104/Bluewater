<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:Bluewater.App.Models"
             xmlns:controls="clr-namespace:Bluewater.App.Views.Controls"
             xmlns:helper="clr-namespace:Bluewater.App.Helpers"
             x:Class="Bluewater.App.Views.TimesheetDetailsView"
             x:Name="RootView">
    <controls:SlideInEditorView x:Name="EditorView"
                                Title="{Binding Source={x:Reference RootView}, Path=Title}"
                                IsOpen="{Binding Source={x:Reference RootView}, Path=IsOpen}"
                                PanelWidthRatio="0.5"
                                UpdateCommand="{Binding Source={x:Reference RootView}, Path=UpdateCommand}"
                                UpdateCommandParameter="{Binding Source={x:Reference RootView}, Path=UpdateCommandParameter}"
                                UpdateButtonText="{Binding Source={x:Reference RootView}, Path=UpdateButtonText}"
                                IsUpdateEnabled="{Binding Source={x:Reference RootView}, Path=IsUpdateEnabled}"
                                CloseCommand="{Binding Source={x:Reference RootView}, Path=CloseCommand}"
                                CloseCommandParameter="{Binding Source={x:Reference RootView}, Path=CloseCommandParameter}">
        <controls:SlideInEditorView.EditorContent>
            <Grid Padding="10" RowDefinitions="Auto,*">
                <Border Grid.Row="0"
                        Stroke="Transparent"
                        BackgroundColor="{StaticResource TextAccentColor}"
                        StrokeShape="RoundRectangle 12">
                    <Grid RowDefinitions="Auto,Auto,Auto,Auto"
                          Padding="20,10">
                        <Label Grid.Row="0" 
                               Text="Edit selected time" />
                        <HorizontalStackLayout Grid.Row="0" 
                                               HorizontalOptions="End" 
                                               Spacing="20" >
                            <Label Text="Time in 1" />
                            <TimePicker TranslationY="7" />
                            <DatePicker />
                        </HorizontalStackLayout>
                        <HorizontalStackLayout Grid.Row="1"
                                               HorizontalOptions="End"
                                               Spacing="20">
                            <Label Text="Time out 1" />
                            <TimePicker TranslationY="7" />
                            <DatePicker />
                        </HorizontalStackLayout>
                        <HorizontalStackLayout Grid.Row="2"
                                               HorizontalOptions="End"
                                               Spacing="20">
                            <Label Text="Time in 2" />
                            <TimePicker TranslationY="7" />
                            <DatePicker />
                        </HorizontalStackLayout>
                        <HorizontalStackLayout Grid.Row="3"
                                               HorizontalOptions="End"
                                               Spacing="20" >
                            <Label Text="Time out 2" />
                            <TimePicker TranslationY="7" />
                            <DatePicker />
                        </HorizontalStackLayout>
                    </Grid>
                </Border>
                <CollectionView x:Name="timeCollection"
                                Grid.Row="1"
                                ItemsSource="{Binding Source={x:Reference RootView}, Path=Timesheets}"
                                SelectionMode="Single">
                    <CollectionView.Header>
                        <Border StrokeShape="RoundRectangle 10 10 0 0"
                                BackgroundColor="{AppThemeBinding Light={StaticResource AccentColor}, Dark=#1F5AA8}">
                            <Grid ColumnSpacing="12"
                                  Padding="20"
                                  ColumnDefinitions="*,*,*,*,*">
                                <Label Text="Date"
                                       TextColor="White"
                                       HorizontalTextAlignment="Center"
                                       FontAttributes="Bold" />
                                <Label Grid.Column="1"
                                       Text="Time in 1"
                                       HorizontalTextAlignment="Center"
                                       TextColor="White"
                                       FontAttributes="Bold" />
                                <Label Grid.Column="2"
                                       Text="Time out 1"
                                       HorizontalTextAlignment="Center"
                                       TextColor="White"
                                       FontAttributes="Bold" />
                                <Label Grid.Column="3"
                                       Text="Time in 2"
                                       HorizontalTextAlignment="Center"
                                       TextColor="White"
                                       FontAttributes="Bold" />
                                <Label Grid.Column="4"
                                       Text="Time out 2"
                                       HorizontalTextAlignment="Center"
                                       TextColor="White"
                                       FontAttributes="Bold" />                                
                            </Grid>
                        </Border>
                    </CollectionView.Header>
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="models:EditableTimesheetEntry">
                            <Border StrokeThickness="1"
                                    Stroke="Transparent"
                                    BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1F1F1F}"
                                    Padding="16,12"
                                    StrokeShape="RoundRectangle 12">
                                <Grid ColumnDefinitions="*,*,*,*,*">
                                    <Label Grid.Column="0"
                                           HorizontalTextAlignment="Center"
                                           Text="{Binding EntryDate, StringFormat='{0: MMM dd yyyy (ddd)}'}" />
                                    <Label Grid.Column="1"
                                           HorizontalTextAlignment="Center"
                                           Text="{Binding TimeIn1, StringFormat='{}{0:HH:mm ttt}'}" />
                                    <Label Grid.Column="2"
                                           HorizontalTextAlignment="Center"
                                           Text="{Binding TimeOut1, StringFormat='{}{0:HH:mm ttt}'}" />
                                    <Label Grid.Column="3"
                                           HorizontalTextAlignment="Center"
                                           Text="{Binding TimeIn2, StringFormat='{}{0:HH:mm ttt}'}" />
                                    <Label Grid.Column="4"
                                           HorizontalTextAlignment="Center"
                                           Text="{Binding TimeOut2, StringFormat='{}{0:HH:mm ttt}'}" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                    <CollectionView.EmptyView>
                        <VerticalStackLayout Padding="24"
                                             Spacing="8"
                                             HorizontalOptions="Center"
                                             VerticalOptions="Center">
                            <Label Text="Select an employee to edit timesheets."
                                   HorizontalTextAlignment="Center"
                                   FontAttributes="Bold" />
                            <Label Text="Timesheet entries will appear here once an employee is selected."
                                   HorizontalTextAlignment="Center"
                                   FontSize="12" />
                        </VerticalStackLayout>
                    </CollectionView.EmptyView>
                </CollectionView>
            </Grid>
        </controls:SlideInEditorView.EditorContent>
    </controls:SlideInEditorView>
</ContentView>
