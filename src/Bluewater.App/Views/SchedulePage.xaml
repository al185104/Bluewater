<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="Bluewater.App.Views.SchedulePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Bluewater.App.ViewModels"
             x:Name="Page"
             Title="Schedules">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Prev"
                     Command="{Binding PreviousWeekAsyncCommand}" />
        <ToolbarItem Text="Next"
                     Command="{Binding NextWeekAsyncCommand}" />
    </ContentPage.ToolbarItems>
    <Grid RowDefinitions="Auto,Auto,Auto,*"
          Padding="12"
          RowSpacing="10">
        <!-- Top: Week + tenant + charging -->
        <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,Auto"
              ColumnSpacing="10">
            <Label Text="Week:"
                   VerticalTextAlignment="Center" />
            <Label Grid.Column="1"
                   Text="{Binding WeekRangeDisplay}"
                   FontAttributes="Bold"
                   VerticalTextAlignment="Center" />
            <Label Grid.Column="2"
                   Text="Tenant:"
                   VerticalTextAlignment="Center" />
            <Picker Grid.Column="3"
                    Title="Select tenant"
                    ItemsSource="{Binding TenantOptions}"
                    SelectedItem="{Binding SelectedTenant, Mode=TwoWay}" />
            <Label Grid.Column="4"
                   Text="Charging:"
                   VerticalTextAlignment="Center" />
            <Picker Grid.Column="5"
                    Title="Select charging"
                    ItemsSource="{Binding Chargings}"
                    ItemDisplayBinding="{Binding Name}"
                    SelectedItem="{Binding SelectedCharging, Mode=TwoWay}" />
        </Grid>
        <!-- Day headers -->
        <Grid Grid.Row="1"
              ColumnDefinitions="2.4*,1.2*,1.2*,1.2*,1.2*,1.2*,1.2*,1.2*"
              ColumnSpacing="8">
            <Label Text="Employee"
                   FontAttributes="Bold" />
            <Label Grid.Column="1"
                   Text="{Binding SundayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="2"
                   Text="{Binding MondayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="3"
                   Text="{Binding TuesdayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="4"
                   Text="{Binding WednesdayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="5"
                   Text="{Binding ThursdayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="6"
                   Text="{Binding FridayHeader}"
                   FontAttributes="Bold" />
            <Label Grid.Column="7"
                   Text="{Binding SaturdayHeader}"
                   FontAttributes="Bold" />
        </Grid>
        <!-- Divider -->
        <BoxView Grid.Row="2"
                 HeightRequest="1"
                 BackgroundColor="{DynamicResource SeparatorColor}" />
        <!-- Rows -->
        <CollectionView Grid.Row="3"
                        ItemsSource="{Binding Employees}"
                        SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="0,8"
                          ColumnDefinitions="2.4*,1.2*,1.2*,1.2*,1.2*,1.2*,1.2*,1.2*"
                          ColumnSpacing="8">
                        <VerticalStackLayout>
                            <Label Text="{Binding Name}"
                                   FontAttributes="Bold"
                                   LineBreakMode="TailTruncation" />
                            <Label Text="{Binding Section}"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}" />
                        </VerticalStackLayout>
                        <!-- One Picker per day. Bind to Day.ShiftOptions + Day.SelectedShift -->
                        <Picker Grid.Column="1"
                                ItemsSource="{Binding Sunday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Sunday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="2"
                                ItemsSource="{Binding Monday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Monday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="3"
                                ItemsSource="{Binding Tuesday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Tuesday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="4"
                                ItemsSource="{Binding Wednesday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Wednesday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="5"
                                ItemsSource="{Binding Thursday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Thursday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="6"
                                ItemsSource="{Binding Friday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Friday.SelectedShift, Mode=TwoWay}" />
                        <Picker Grid.Column="7"
                                ItemsSource="{Binding Saturday.ShiftOptions}"
                                ItemDisplayBinding="{Binding DisplayName}"
                                SelectedItem="{Binding Saturday.SelectedShift, Mode=TwoWay}" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
